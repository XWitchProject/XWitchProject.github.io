<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Relua: Relua.Script API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Relua
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespaceRelua_1_1Script.html">Relua.Script</a> API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Visitor functions</h1>
<p><a class="el" href="namespaceRelua_1_1Script.html">Relua.Script</a> uses the Visitor pattern to make AST transformations easy. Each node type (see Types section below) can have its own global function with the same name as the type. If such a function exists when the script is loaded, it will be used by the <code>enter(node)</code> builtin function.</p>
<p>The first function that is ran is always the <code>Block</code> visitor (because parsing a file returns a <code>Block</code>). A simple implementation might look like this:</p>
<div class="fragment"><div class="line">function Block(node)</div>
<div class="line">    node.Statements:iter(function(i, stat)</div>
<div class="line">        enter(stat)</div>
<div class="line">    end)</div>
<div class="line">end</div>
</div><!-- fragment --><p>An implementation like this will remove all global top level assignments, alongside renaming all function calls to <code>print</code>.</p>
<div class="fragment"><div class="line">function FunctionCall(node)</div>
<div class="line">    node.Function = astexpr(&quot;print&quot;)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">function Block(node)</div>
<div class="line">    node.Statements:reverse_iter(function(i, stat)</div>
<div class="line">        if (asttype(stat) == &quot;Assignment&quot;) then</div>
<div class="line">            node.Statements:remove(i)</div>
<div class="line">        else</div>
<div class="line">            enter(stat)</div>
<div class="line">        end</div>
<div class="line">    end)</div>
<div class="line">end</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
Builtin functions</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
&lt;tt&gt;enter(node)&lt;/tt&gt;</h2>
<p>Runs the appropriate type function based on the type of <code>node</code>.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
&lt;tt&gt;astnew(nodetype)&lt;/tt&gt;</h2>
<p>Returns a new AST node of type <code>nodetype</code>. See Types section below. Note that lists cannot be instantiated.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
&lt;tt&gt;astexpr(expr)&lt;/tt&gt;</h2>
<p>Parses the string in <code>expr</code> and returns an expression node.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
&lt;tt&gt;aststat(stat)&lt;/tt&gt;</h2>
<p>Parses the string in <code>stat</code> and returns a statement node.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
&lt;tt&gt;astfile(path)&lt;/tt&gt;</h2>
<p>Parses the file at <code>path</code> and returns its <code>Block</code> node.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
&lt;tt&gt;asttype(node)&lt;/tt&gt;</h2>
<p>Returns the type name of <code>node</code>.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
Types</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
List</h2>
<p>Note: lists are 1-indexed.</p>
<p>Available Properties and Functions:</p>
<ul>
<li><code>list.count</code></li>
<li>getter (<code>list[idx]</code>)</li>
<li>setter (<code>list[idx] = val</code>)</li>
<li><code>list:add(elem)</code></li>
<li><code>list:insert(idx, elem)</code></li>
<li><code>list:remove(idx)</code></li>
<li><code>list:clear()</code></li>
<li><code>list:iter(function(index, entry) ... end)</code></li>
<li><code>list:reverse_iter(function(index, entry) ... end)</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
Variable (expression, assignable)</h2>
<ul>
<li><code>Name</code> (string)</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
NilLiteral (expression)</h2>
<p>No fields.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
VarargsLiteral (expression)</h2>
<p>No fields.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
BoolLiteral (expression)</h2>
<ul>
<li><code>Value</code> (bool)</li>
</ul>
<h2><a class="anchor" id="autotoc_md15"></a>
UnaryOp (expression)</h2>
<ul>
<li><code>Type</code> (string)<ul>
<li><code>Negate</code> (<code>not</code>)</li>
<li><code>Invert</code> (<code>-</code>)</li>
<li><code>Length</code> (<code>#</code>)</li>
</ul>
</li>
<li><code>Expression</code> (expression node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
BinaryOp (expression)</h2>
<ul>
<li><code>Type</code> (string)<ul>
<li><code>Add</code> (<code>+</code>)</li>
<li><code>Subtract</code> (<code>-</code>)</li>
<li><code>Multiply</code> (<code>*</code>)</li>
<li><code>Divide</code> (<code>/</code>)</li>
<li><code>Power</code> (<code>^</code>)</li>
<li><code>Modulo</code> (<code>%</code>)</li>
<li><code>Concat</code> (<code>..</code>)</li>
<li><code>GreaterThan</code> (<code>&gt;</code>)</li>
<li><code>GreaterOrEqual</code> (<code>&gt;=</code>)</li>
<li><code>LessThan</code> (<code>&lt;</code>)</li>
<li><code>LessOrEqual</code> (<code>&lt;=</code>)</li>
<li><code>Equal</code> (<code>==</code>)</li>
<li><code>NotEqual</code> (<code>~=</code>)</li>
<li><code>And</code> (<code>and</code>)</li>
<li><code>Or</code> (<code>or</code>)</li>
</ul>
</li>
<li><code>Left</code> (expression node)</li>
<li><code>Right</code> (expression node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md17"></a>
StringLiteral (expression)</h2>
<ul>
<li><code>Value</code> (string)</li>
</ul>
<h2><a class="anchor" id="autotoc_md18"></a>
NumberLiteral (expression)</h2>
<ul>
<li><code>Value</code> (number)</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
LuaJITLongLiteral (expression)</h2>
<ul>
<li><code>Value</code> (number)</li>
</ul>
<h2><a class="anchor" id="autotoc_md20"></a>
TableAccess (expression, assignable)</h2>
<ul>
<li><code>Table</code> (expression node)</li>
<li><code>Index</code> (expression node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md21"></a>
FunctionCall (expression, statement)</h2>
<ul>
<li><code>Function</code> (expression node)</li>
<li><code>Arguments</code> (list of expression nodes)</li>
<li><code>ForceTruncateReturnValues</code> (bool)</li>
</ul>
<h2><a class="anchor" id="autotoc_md22"></a>
TableConstructor (expression)</h2>
<ul>
<li><code>Entries</code> (list of <code>TableConstructorEntry</code> nodes)</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
TableConstructorEntry</h2>
<ul>
<li><code>Key</code> (expression node)</li>
<li><code>Value</code> (expression node)</li>
<li><code>ExplicitKey</code> (bool)</li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
Break (statement)</h2>
<p>No fields.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Return (statement)</h2>
<ul>
<li><code>Expressions</code> (list of expression nodes)</li>
</ul>
<h2><a class="anchor" id="autotoc_md26"></a>
Block (statement)</h2>
<ul>
<li><code>Statements</code> (list of statement nodes)</li>
<li><code>TopLevel</code> (bool)</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
ConditionalBlock</h2>
<ul>
<li><code>Condition</code> (expression node)</li>
<li><code>Block</code> (<code>Block</code> node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
If (statement)</h2>
<ul>
<li><code>MainIf</code> (<code>ConditionalBlock</code> node)</li>
<li><code>ElseIfs</code> (list of <code>ConditionalBlock</code> nodes)</li>
<li><code>Else</code> (<code>Block</code> node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
While (statement)</h2>
<ul>
<li><code>Condition</code> (expression node)</li>
<li><code>Block</code> (<code>Block</code> node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md30"></a>
Repeat (statement)</h2>
<ul>
<li><code>Condition</code> (expression node)</li>
<li><code>Block</code> (<code>Block</code> node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
FunctionDefinition (expression, statement)</h2>
<ul>
<li><code>ArgumentNames</code> (list of strings)</li>
<li><code>Block</code> (<code>Block</code> node)</li>
<li><code>AcceptsVarargs</code> (bool)</li>
<li><code>ImplicitSelf</code> (bool)</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
Assignment (statement)</h2>
<ul>
<li><code>IsLocal</code> (bool)</li>
<li><code>Targets</code> (list of assignable nodes)</li>
<li><code>Values</code> (list of expression nodes)</li>
</ul>
<h2><a class="anchor" id="autotoc_md33"></a>
NumericFor (statement)</h2>
<ul>
<li><code>VariableName</code> (string)</li>
<li><code>StartPoint</code> (expression node)</li>
<li><code>EndPoint</code> (expression node)</li>
<li><code>Step</code> (expression node)</li>
</ul>
<h2><a class="anchor" id="autotoc_md34"></a>
GenericFor (statement)</h2>
<ul>
<li><code>VariableNames</code> (list of strings)</li>
<li><code>Iterator</code> (expression node) </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
